---
layout: post
title: "100 Days of YARA - Day 50"
date: 2023-02-19 00:00:00 -0000
categories: yara
---

# YARA Command line: Performance - Fast scan
The `-f` flag enables YARA to run in `fast scan` mode, but it isn't immediately clear what this means. However, there is some documentation on this feature (search for `SCAN_FLAGS_FAST_MODE` on the following page): [https://yara.readthedocs.io/en/stable/capi.html?highlight=fast#scanning-data-1](https://yara.readthedocs.io/en/stable/capi.html?highlight=fast#scanning-data-1)

As the docs point out:
> The SCAN_FLAGS_FAST_MODE flag makes the scanning a little faster by avoiding multiple matches of the same string when not necessary. Once the string was found in the file it's subsequently ignored, implying that you'll have a single match for the string, even if it appears multiple times in the scanned data. This flag has the same effect of the -f command-line option described in Running YARA from the command-line.

For strings that are common and appear multiple times in files, this flag will speed things up/[possibly prevent errors](https://twitter.com/plusvic/status/1248170739854958592). However, as the description mentions, this comes at a cost: `implying that you'll have a single match for the string, even if it appears multiple times in the scanned data`

As such, any rules that rely on the count of a string (i.e. the count of string `$test` can be obtained via `#test`), or iterating over offsets to string (i.e. the 5th occurance of `$test` would be `@test[5]` - yes, [they are indexed from 1](https://yara.readthedocs.io/en/stable/writingrules.html#string-offsets-or-virtual-addresses)) will not properly evaluate.